[2023-10-11 12:13:27,207][HYDRA] Hydra 1.2.0
[2023-10-11 12:13:27,208][HYDRA] ===========
[2023-10-11 12:13:27,208][HYDRA] Installed Hydra Plugins
[2023-10-11 12:13:27,208][HYDRA] ***********************
[2023-10-11 12:13:27,208][HYDRA] 	ConfigSource:
[2023-10-11 12:13:27,208][HYDRA] 	-------------
[2023-10-11 12:13:27,208][HYDRA] 		FileConfigSource
[2023-10-11 12:13:27,208][HYDRA] 		ImportlibResourcesConfigSource
[2023-10-11 12:13:27,208][HYDRA] 		StructuredConfigSource
[2023-10-11 12:13:27,208][HYDRA] 	CompletionPlugin:
[2023-10-11 12:13:27,208][HYDRA] 	-----------------
[2023-10-11 12:13:27,208][HYDRA] 		BashCompletion
[2023-10-11 12:13:27,208][HYDRA] 		FishCompletion
[2023-10-11 12:13:27,208][HYDRA] 		ZshCompletion
[2023-10-11 12:13:27,208][HYDRA] 	Launcher:
[2023-10-11 12:13:27,208][HYDRA] 	---------
[2023-10-11 12:13:27,208][HYDRA] 		BasicLauncher
[2023-10-11 12:13:27,208][HYDRA] 	Sweeper:
[2023-10-11 12:13:27,208][HYDRA] 	--------
[2023-10-11 12:13:27,208][HYDRA] 		BasicSweeper
[2023-10-11 12:13:27,208][HYDRA] 
[2023-10-11 12:13:27,208][HYDRA] Config search path
[2023-10-11 12:13:27,208][HYDRA] ******************
[2023-10-11 12:13:27,226][HYDRA] Hydra 1.2.0
[2023-10-11 12:13:27,226][HYDRA] ===========
[2023-10-11 12:13:27,226][HYDRA] Installed Hydra Plugins
[2023-10-11 12:13:27,226][HYDRA] ***********************
[2023-10-11 12:13:27,226][HYDRA] 	ConfigSource:
[2023-10-11 12:13:27,226][HYDRA] 	-------------
[2023-10-11 12:13:27,226][HYDRA] 		FileConfigSource
[2023-10-11 12:13:27,226][HYDRA] 		ImportlibResourcesConfigSource
[2023-10-11 12:13:27,226][HYDRA] 		StructuredConfigSource
[2023-10-11 12:13:27,226][HYDRA] 	CompletionPlugin:
[2023-10-11 12:13:27,226][HYDRA] 	-----------------
[2023-10-11 12:13:27,226][HYDRA] 		BashCompletion
[2023-10-11 12:13:27,226][HYDRA] 		FishCompletion
[2023-10-11 12:13:27,226][HYDRA] 		ZshCompletion
[2023-10-11 12:13:27,226][HYDRA] 	Launcher:
[2023-10-11 12:13:27,227][HYDRA] 	---------
[2023-10-11 12:13:27,227][HYDRA] 		BasicLauncher
[2023-10-11 12:13:27,227][HYDRA] 	Sweeper:
[2023-10-11 12:13:27,227][HYDRA] 	--------
[2023-10-11 12:13:27,227][HYDRA] 		BasicSweeper
[2023-10-11 12:13:27,227][HYDRA] 
[2023-10-11 12:13:27,227][HYDRA] Config search path
[2023-10-11 12:13:27,227][HYDRA] ******************
[2023-10-11 12:13:27,422][HYDRA] | Provider | Search path                                                      |
[2023-10-11 12:13:27,422][HYDRA] -------------------------------------------------------------------------------
[2023-10-11 12:13:27,423][HYDRA] | hydra    | pkg://hydra.conf                                                 |
[2023-10-11 12:13:27,423][HYDRA] | main     | file:///home/disk/quicksilver/nacc/dlesm/zephyr/training/configs |
[2023-10-11 12:13:27,423][HYDRA] | schema   | structured://                                                    |
[2023-10-11 12:13:27,423][HYDRA] -------------------------------------------------------------------------------
[2023-10-11 12:13:27,454][HYDRA] | Provider | Search path                                                      |
[2023-10-11 12:13:27,454][HYDRA] -------------------------------------------------------------------------------
[2023-10-11 12:13:27,454][HYDRA] | hydra    | pkg://hydra.conf                                                 |
[2023-10-11 12:13:27,454][HYDRA] | main     | file:///home/disk/quicksilver/nacc/dlesm/zephyr/training/configs |
[2023-10-11 12:13:27,454][HYDRA] | schema   | structured://                                                    |
[2023-10-11 12:13:27,454][HYDRA] -------------------------------------------------------------------------------
[2023-10-11 12:13:27,551][HYDRA] 
[2023-10-11 12:13:27,551][HYDRA] Defaults Tree
[2023-10-11 12:13:27,551][HYDRA] *************
[2023-10-11 12:13:27,551][HYDRA] <root>:
[2023-10-11 12:13:27,551][HYDRA]   hydra/config:
[2023-10-11 12:13:27,551][HYDRA]     hydra/output: default
[2023-10-11 12:13:27,552][HYDRA]     hydra/launcher: basic
[2023-10-11 12:13:27,552][HYDRA]     hydra/sweeper: basic
[2023-10-11 12:13:27,552][HYDRA]     hydra/help: default
[2023-10-11 12:13:27,552][HYDRA]     hydra/hydra_help: default
[2023-10-11 12:13:27,552][HYDRA]     hydra/hydra_logging: default
[2023-10-11 12:13:27,552][HYDRA]     hydra/job_logging: default
[2023-10-11 12:13:27,552][HYDRA]     hydra/callbacks: null
[2023-10-11 12:13:27,552][HYDRA]     hydra/env: default
[2023-10-11 12:13:27,552][HYDRA]     _self_
[2023-10-11 12:13:27,552][HYDRA]   config:
[2023-10-11 12:13:27,552][HYDRA]     _self_
[2023-10-11 12:13:27,552][HYDRA]     data: era5_hpx64_7var_6h_24h:
[2023-10-11 12:13:27,552][HYDRA]       data/module: time_series
[2023-10-11 12:13:27,552][HYDRA]       data/scaling: classic
[2023-10-11 12:13:27,552][HYDRA]       data/splits: default
[2023-10-11 12:13:27,552][HYDRA]       _self_
[2023-10-11 12:13:27,552][HYDRA]     model: hpx_rec_unet:
[2023-10-11 12:13:27,552][HYDRA]       model/modules/encoder@model.encoder: rec_unet_enc:
[2023-10-11 12:13:27,552][HYDRA]         model/modules/blocks@model.encoder.conv_block: conv_next_block:
[2023-10-11 12:13:27,552][HYDRA]           model/modules/activations@model.encoder.conv_block.activation: capped_gelu
[2023-10-11 12:13:27,552][HYDRA]           model/modules/encoder/_self_
[2023-10-11 12:13:27,553][HYDRA]         model/modules/blocks@model.encoder.down_sampling_block: avg_pool
[2023-10-11 12:13:27,553][HYDRA]         model/modules/blocks@model.encoder.recurrent_block: conv_gru_block
[2023-10-11 12:13:27,553][HYDRA]         model/_self_
[2023-10-11 12:13:27,553][HYDRA]       model/modules/decoder@model.decoder: rec_unet_dec:
[2023-10-11 12:13:27,553][HYDRA]         model/modules/blocks@model.decoder.conv_block: conv_next_block:
[2023-10-11 12:13:27,553][HYDRA]           model/modules/activations@model.decoder.conv_block.activation: capped_gelu
[2023-10-11 12:13:27,553][HYDRA]           model/modules/decoder/_self_
[2023-10-11 12:13:27,553][HYDRA]         model/modules/blocks@model.decoder.up_sampling_block: transposed_conv_upsample:
[2023-10-11 12:13:27,553][HYDRA]           model/modules/activations@model.decoder.up_sampling_block.activation: capped_gelu
[2023-10-11 12:13:27,553][HYDRA]           model/modules/decoder/_self_
[2023-10-11 12:13:27,553][HYDRA]         model/modules/blocks@model.decoder.recurrent_block: conv_gru_block
[2023-10-11 12:13:27,553][HYDRA]         model/modules/blocks@model.decoder.output_layer: output_layer:
[2023-10-11 12:13:27,553][HYDRA]           model/modules/blocks/activation@model.decoder.output_layer.activation: null
[2023-10-11 12:13:27,553][HYDRA]           model/modules/decoder/_self_
[2023-10-11 12:13:27,553][HYDRA]         model/_self_
[2023-10-11 12:13:27,553][HYDRA]       _self_
[2023-10-11 12:13:27,553][HYDRA]     trainer: default:
[2023-10-11 12:13:27,553][HYDRA]       trainer/criterion: mse
[2023-10-11 12:13:27,553][HYDRA]       trainer/optimizer: adam
[2023-10-11 12:13:27,553][HYDRA]       trainer/lr_scheduler: cosine
[2023-10-11 12:13:27,553][HYDRA]       _self_
[2023-10-11 12:13:27,591][HYDRA] 
[2023-10-11 12:13:27,591][HYDRA] Defaults Tree
[2023-10-11 12:13:27,591][HYDRA] *************
[2023-10-11 12:13:27,591][HYDRA] <root>:
[2023-10-11 12:13:27,591][HYDRA]   hydra/config:
[2023-10-11 12:13:27,591][HYDRA]     hydra/output: default
[2023-10-11 12:13:27,591][HYDRA]     hydra/launcher: basic
[2023-10-11 12:13:27,591][HYDRA]     hydra/sweeper: basic
[2023-10-11 12:13:27,591][HYDRA]     hydra/help: default
[2023-10-11 12:13:27,591][HYDRA]     hydra/hydra_help: default
[2023-10-11 12:13:27,591][HYDRA]     hydra/hydra_logging: default
[2023-10-11 12:13:27,591][HYDRA]     hydra/job_logging: default
[2023-10-11 12:13:27,591][HYDRA]     hydra/callbacks: null
[2023-10-11 12:13:27,591][HYDRA]     hydra/env: default
[2023-10-11 12:13:27,591][HYDRA]     _self_
[2023-10-11 12:13:27,591][HYDRA]   config:
[2023-10-11 12:13:27,591][HYDRA]     _self_
[2023-10-11 12:13:27,591][HYDRA]     data: era5_hpx64_7var_6h_24h:
[2023-10-11 12:13:27,591][HYDRA]       data/module: time_series
[2023-10-11 12:13:27,591][HYDRA]       data/scaling: classic
[2023-10-11 12:13:27,591][HYDRA]       data/splits: default
[2023-10-11 12:13:27,591][HYDRA]       _self_
[2023-10-11 12:13:27,592][HYDRA]     model: hpx_rec_unet:
[2023-10-11 12:13:27,592][HYDRA]       model/modules/encoder@model.encoder: rec_unet_enc:
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.encoder.conv_block: conv_next_block:
[2023-10-11 12:13:27,592][HYDRA]           model/modules/activations@model.encoder.conv_block.activation: capped_gelu
[2023-10-11 12:13:27,592][HYDRA]           model/modules/encoder/_self_
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.encoder.down_sampling_block: avg_pool
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.encoder.recurrent_block: conv_gru_block
[2023-10-11 12:13:27,592][HYDRA]         model/_self_
[2023-10-11 12:13:27,592][HYDRA]       model/modules/decoder@model.decoder: rec_unet_dec:
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.decoder.conv_block: conv_next_block:
[2023-10-11 12:13:27,592][HYDRA]           model/modules/activations@model.decoder.conv_block.activation: capped_gelu
[2023-10-11 12:13:27,592][HYDRA]           model/modules/decoder/_self_
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.decoder.up_sampling_block: transposed_conv_upsample:
[2023-10-11 12:13:27,592][HYDRA]           model/modules/activations@model.decoder.up_sampling_block.activation: capped_gelu
[2023-10-11 12:13:27,592][HYDRA]           model/modules/decoder/_self_
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.decoder.recurrent_block: conv_gru_block
[2023-10-11 12:13:27,592][HYDRA]         model/modules/blocks@model.decoder.output_layer: output_layer:
[2023-10-11 12:13:27,592][HYDRA]           model/modules/blocks/activation@model.decoder.output_layer.activation: null
[2023-10-11 12:13:27,592][HYDRA]           model/modules/decoder/_self_
[2023-10-11 12:13:27,592][HYDRA]         model/_self_
[2023-10-11 12:13:27,592][HYDRA]       _self_
[2023-10-11 12:13:27,592][HYDRA]     trainer: default:
[2023-10-11 12:13:27,592][HYDRA]       trainer/criterion: mse
[2023-10-11 12:13:27,593][HYDRA]       trainer/optimizer: adam
[2023-10-11 12:13:27,593][HYDRA]       trainer/lr_scheduler: cosine
[2023-10-11 12:13:27,593][HYDRA]       _self_
[2023-10-11 12:13:27,682][HYDRA] 
[2023-10-11 12:13:27,683][HYDRA] Defaults List
[2023-10-11 12:13:27,683][HYDRA] *************
[2023-10-11 12:13:27,683][HYDRA] | Config path                                   | Package                                    | _self_ | Parent                                        | 
[2023-10-11 12:13:27,683][HYDRA] --------------------------------------------------------------------------------------------------------------------------------------------------------
[2023-10-11 12:13:27,683][HYDRA] | hydra/output/default                          | hydra                                      | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/launcher/basic                          | hydra.launcher                             | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/sweeper/basic                           | hydra.sweeper                              | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/help/default                            | hydra.help                                 | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/hydra_help/default                      | hydra.hydra_help                           | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/hydra_logging/default                   | hydra.hydra_logging                        | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/job_logging/default                     | hydra.job_logging                          | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/env/default                             | hydra.env                                  | False  | hydra/config                                  |
[2023-10-11 12:13:27,683][HYDRA] | hydra/config                                  | hydra                                      | True   | <root>                                        |
[2023-10-11 12:13:27,683][HYDRA] | config                                        |                                            | True   | <root>                                        |
[2023-10-11 12:13:27,683][HYDRA] | data/module/time_series                       | data.module                                | False  | data/era5_hpx64_7var_6h_24h                   |
[2023-10-11 12:13:27,683][HYDRA] | data/scaling/classic                          | data.scaling                               | False  | data/era5_hpx64_7var_6h_24h                   |
[2023-10-11 12:13:27,683][HYDRA] | data/splits/default                           | data.splits                                | False  | data/era5_hpx64_7var_6h_24h                   |
[2023-10-11 12:13:27,683][HYDRA] | data/era5_hpx64_7var_6h_24h                   | data                                       | True   | config                                        |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/activations/capped_gelu         | model.encoder.conv_block.activation        | False  | model/modules/blocks/conv_next_block          |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/conv_next_block          | model.encoder.conv_block                   | True   | model/modules/encoder/rec_unet_enc            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/avg_pool                 | model.encoder.down_sampling_block          | False  | model/modules/encoder/rec_unet_enc            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/conv_gru_block           | model.encoder.recurrent_block              | False  | model/modules/encoder/rec_unet_enc            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/encoder/rec_unet_enc            | model.encoder                              | True   | model/hpx_rec_unet                            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/activations/capped_gelu         | model.decoder.conv_block.activation        | False  | model/modules/blocks/conv_next_block          |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/conv_next_block          | model.decoder.conv_block                   | True   | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/activations/capped_gelu         | model.decoder.up_sampling_block.activation | False  | model/modules/blocks/transposed_conv_upsample |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/transposed_conv_upsample | model.decoder.up_sampling_block            | True   | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/conv_gru_block           | model.decoder.recurrent_block              | False  | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/blocks/output_layer             | model.decoder.output_layer                 | True   | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,683][HYDRA] | model/modules/decoder/rec_unet_dec            | model.decoder                              | True   | model/hpx_rec_unet                            |
[2023-10-11 12:13:27,683][HYDRA] | model/hpx_rec_unet                            | model                                      | True   | config                                        |
[2023-10-11 12:13:27,683][HYDRA] | trainer/criterion/mse                         | trainer.criterion                          | False  | trainer/default                               |
[2023-10-11 12:13:27,683][HYDRA] | trainer/optimizer/adam                        | trainer.optimizer                          | False  | trainer/default                               |
[2023-10-11 12:13:27,683][HYDRA] | trainer/lr_scheduler/cosine                   | trainer.lr_scheduler                       | False  | trainer/default                               |
[2023-10-11 12:13:27,683][HYDRA] | trainer/default                               | trainer                                    | True   | config                                        |
[2023-10-11 12:13:27,683][HYDRA] --------------------------------------------------------------------------------------------------------------------------------------------------------
[2023-10-11 12:13:27,726][HYDRA] 
[2023-10-11 12:13:27,726][HYDRA] Defaults List
[2023-10-11 12:13:27,726][HYDRA] *************
[2023-10-11 12:13:27,726][HYDRA] | Config path                                   | Package                                    | _self_ | Parent                                        | 
[2023-10-11 12:13:27,726][HYDRA] --------------------------------------------------------------------------------------------------------------------------------------------------------
[2023-10-11 12:13:27,726][HYDRA] | hydra/output/default                          | hydra                                      | False  | hydra/config                                  |
[2023-10-11 12:13:27,726][HYDRA] | hydra/launcher/basic                          | hydra.launcher                             | False  | hydra/config                                  |
[2023-10-11 12:13:27,726][HYDRA] | hydra/sweeper/basic                           | hydra.sweeper                              | False  | hydra/config                                  |
[2023-10-11 12:13:27,726][HYDRA] | hydra/help/default                            | hydra.help                                 | False  | hydra/config                                  |
[2023-10-11 12:13:27,726][HYDRA] | hydra/hydra_help/default                      | hydra.hydra_help                           | False  | hydra/config                                  |
[2023-10-11 12:13:27,727][HYDRA] | hydra/hydra_logging/default                   | hydra.hydra_logging                        | False  | hydra/config                                  |
[2023-10-11 12:13:27,727][HYDRA] | hydra/job_logging/default                     | hydra.job_logging                          | False  | hydra/config                                  |
[2023-10-11 12:13:27,727][HYDRA] | hydra/env/default                             | hydra.env                                  | False  | hydra/config                                  |
[2023-10-11 12:13:27,727][HYDRA] | hydra/config                                  | hydra                                      | True   | <root>                                        |
[2023-10-11 12:13:27,727][HYDRA] | config                                        |                                            | True   | <root>                                        |
[2023-10-11 12:13:27,727][HYDRA] | data/module/time_series                       | data.module                                | False  | data/era5_hpx64_7var_6h_24h                   |
[2023-10-11 12:13:27,727][HYDRA] | data/scaling/classic                          | data.scaling                               | False  | data/era5_hpx64_7var_6h_24h                   |
[2023-10-11 12:13:27,727][HYDRA] | data/splits/default                           | data.splits                                | False  | data/era5_hpx64_7var_6h_24h                   |
[2023-10-11 12:13:27,727][HYDRA] | data/era5_hpx64_7var_6h_24h                   | data                                       | True   | config                                        |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/activations/capped_gelu         | model.encoder.conv_block.activation        | False  | model/modules/blocks/conv_next_block          |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/conv_next_block          | model.encoder.conv_block                   | True   | model/modules/encoder/rec_unet_enc            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/avg_pool                 | model.encoder.down_sampling_block          | False  | model/modules/encoder/rec_unet_enc            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/conv_gru_block           | model.encoder.recurrent_block              | False  | model/modules/encoder/rec_unet_enc            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/encoder/rec_unet_enc            | model.encoder                              | True   | model/hpx_rec_unet                            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/activations/capped_gelu         | model.decoder.conv_block.activation        | False  | model/modules/blocks/conv_next_block          |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/conv_next_block          | model.decoder.conv_block                   | True   | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/activations/capped_gelu         | model.decoder.up_sampling_block.activation | False  | model/modules/blocks/transposed_conv_upsample |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/transposed_conv_upsample | model.decoder.up_sampling_block            | True   | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/conv_gru_block           | model.decoder.recurrent_block              | False  | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/blocks/output_layer             | model.decoder.output_layer                 | True   | model/modules/decoder/rec_unet_dec            |
[2023-10-11 12:13:27,727][HYDRA] | model/modules/decoder/rec_unet_dec            | model.decoder                              | True   | model/hpx_rec_unet                            |
[2023-10-11 12:13:27,727][HYDRA] | model/hpx_rec_unet                            | model                                      | True   | config                                        |
[2023-10-11 12:13:27,727][HYDRA] | trainer/criterion/mse                         | trainer.criterion                          | False  | trainer/default                               |
[2023-10-11 12:13:27,727][HYDRA] | trainer/optimizer/adam                        | trainer.optimizer                          | False  | trainer/default                               |
[2023-10-11 12:13:27,727][HYDRA] | trainer/lr_scheduler/cosine                   | trainer.lr_scheduler                       | False  | trainer/default                               |
[2023-10-11 12:13:27,727][HYDRA] | trainer/default                               | trainer                                    | True   | config                                        |
[2023-10-11 12:13:27,727][HYDRA] --------------------------------------------------------------------------------------------------------------------------------------------------------
[2023-10-11 12:13:27,883][HYDRA] Config
[2023-10-11 12:13:27,884][HYDRA] ******
[2023-10-11 12:13:27,896][HYDRA] experiment_name: hpx64_unet_136-68-34_cnxt_skip_dil_gru_6h_300_seed0
output_dir: outputs/${experiment_name}
checkpoint_name: null
load_weights_only: false
seed: 0
batch_size: 6
learning_rate: 0.0002
num_workers: 8
port: 29450
master_address: localhost
data:
  module:
    _target_: training.dlwp.data.modules.TimeSeriesDataModule
    src_directory: ${data.src_directory}
    dst_directory: ${data.dst_directory}
    dataset_name: ${data.dataset_name}
    prefix: ${data.prefix}
    suffix: ${data.suffix}
    data_format: ${data.data_format}
    batch_size: ${batch_size}
    drop_last: true
    input_variables: ${data.input_variables}
    output_variables: ${data.output_variables}
    constants: ${data.constants}
    scaling: ${data.scaling}
    splits: ${data.splits}
    presteps: ${model.presteps}
    input_time_dim: ${data.input_time_dim}
    output_time_dim: ${data.output_time_dim}
    data_time_step: ${data.data_time_step}
    time_step: ${data.time_step}
    gap: ${data.gap}
    shuffle: true
    add_insolation: ${data.add_insolation}
    cube_dim: ${data.cube_dim}
    num_workers: ${num_workers}
    pin_memory: true
    prebuilt_dataset: ${data.prebuilt_dataset}
  scaling:
    t2m0:
      mean: 287.8665771484375
      std: 14.86227798461914
    t850:
      mean: 281.2710266113281
      std: 12.04991626739502
    tau300-700:
      mean: 61902.72265625
      std: 2559.8408203125
    tcwv0:
      mean: 24.034976959228516
      std: 16.411935806274414
    z1000:
      mean: 952.1435546875
      std: 895.7516479492188
    z250:
      mean: 101186.28125
      std: 5551.77978515625
    z500:
      mean: 55625.9609375
      std: 2681.712890625
    tp6:
      mean: 0.0
      std: 1.0
      log_epsilon: 1.0e-06
  splits:
    train_date_start: '1979-01-01'
    train_date_end: 2012-12-31T18:00
    val_date_start: '2013-01-01'
    val_date_end: 2016-12-31T18:00
    test_date_start: '2017-01-01'
    test_date_end: 2018-12-31T18:00
  src_directory: /home/quicksilver2/karlbam/Data/DLWP/HPX64
  dst_directory: /home/quicksilver2/karlbam/Data/DLWP/HPX64
  dataset_name: era5_hpx64_7var_6h_24h
  prefix: era5_0.25deg_3h_HPX64_1979-2021_
  suffix: ''
  data_format: classic
  input_variables:
  - z500
  - tau300-700
  - z1000
  - t2m0
  - tcwv0
  - t850
  - z250
  output_variables: null
  constants:
    land_sea_mask: lsm
    topography: z
  input_time_dim: 2
  output_time_dim: 4
  data_time_step: 3H
  time_step: 6H
  gap: 6H
  add_insolation: true
  nside: 64
  cube_dim: ${data.nside}
  prebuilt_dataset: true
model:
  encoder:
    conv_block:
      activation:
        _target_: training.dlwp.model.modules.activations.CappedGELU
        cap_value: 10
      _target_: training.dlwp.model.modules.blocks.ConvNeXtBlock
      _recursive_: true
      in_channels: 3
      out_channels: 1
      kernel_size: 3
      dilation: 1
      upscale_factor: 4
    down_sampling_block:
      _target_: training.dlwp.model.modules.blocks.AvgPool
      pooling: 2
    recurrent_block:
      _target_: training.dlwp.model.modules.blocks.ConvGRUBlock
      _recursive_: false
      in_channels: 3
      kernel_size: 1
      downscale_factor: 4
    _target_: training.dlwp.model.modules.encoder.UNetEncoder
    _recursive_: false
    n_channels:
    - 136
    - 68
    - 34
    dilations:
    - 1
    - 2
    - 4
  decoder:
    conv_block:
      activation:
        _target_: training.dlwp.model.modules.activations.CappedGELU
        cap_value: 10
      _target_: training.dlwp.model.modules.blocks.ConvNeXtBlock
      _recursive_: true
      in_channels: 3
      out_channels: 1
      kernel_size: 3
      dilation: 1
      upscale_factor: 4
    up_sampling_block:
      activation:
        _target_: training.dlwp.model.modules.activations.CappedGELU
        cap_value: 10
      _target_: training.dlwp.model.modules.blocks.TransposedConvUpsample
      in_channels: 3
      out_channels: 1
      upsampling: 2
    recurrent_block:
      _target_: training.dlwp.model.modules.blocks.ConvGRUBlock
      _recursive_: false
      in_channels: 3
      kernel_size: 1
      downscale_factor: 4
    output_layer:
      _target_: training.dlwp.model.modules.blocks.BasicConvBlock
      in_channels: 3
      out_channels: 2
      kernel_size: 1
      dilation: 1
      n_layers: 1
    _target_: training.dlwp.model.modules.decoder.UNetDecoder
    _recursive_: false
    n_channels:
    - 34
    - 68
    - 136
    dilations:
    - 4
    - 2
    - 1
  _target_: training.dlwp.model.models.unet.HEALPixRecUNet
  _recursive_: false
  presteps: 1
  input_time_dim: ${data.input_time_dim}
  output_time_dim: ${data.output_time_dim}
  delta_time: ${data.time_step}
  input_channels: 7
  output_channels: 7
  n_constants: 2
  decoder_input_channels: 1
  enable_nhwc: false
  enable_healpixpad: true
trainer:
  criterion:
    _target_: training.dlwp.trainer.criterion.BaseMSE
  optimizer:
    _target_: torch.optim.Adam
    lr: ${learning_rate}
  lr_scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingLR
    optimizer: ${model.optimizer}
    T_max: ${trainer.max_epochs}
    eta_min: 0
    last_epoch: -1
    verbose: false
  _target_: training.dlwp.trainer.trainer.Trainer
  _recursive_: true
  max_epochs: 300
  min_epochs: 1
  early_stopping_patience: null
  amp_mode: fp16
  graph_mode: train_eval
  output_dir: ${output_dir}

[2023-10-11 12:13:27,946][HYDRA] Config
[2023-10-11 12:13:27,947][HYDRA] ******
[2023-10-11 12:13:27,959][HYDRA] experiment_name: hpx64_unet_136-68-34_cnxt_skip_dil_gru_6h_300_seed0
output_dir: outputs/${experiment_name}
checkpoint_name: null
load_weights_only: false
seed: 0
batch_size: 6
learning_rate: 0.0002
num_workers: 8
port: 29450
master_address: localhost
data:
  module:
    _target_: training.dlwp.data.modules.TimeSeriesDataModule
    src_directory: ${data.src_directory}
    dst_directory: ${data.dst_directory}
    dataset_name: ${data.dataset_name}
    prefix: ${data.prefix}
    suffix: ${data.suffix}
    data_format: ${data.data_format}
    batch_size: ${batch_size}
    drop_last: true
    input_variables: ${data.input_variables}
    output_variables: ${data.output_variables}
    constants: ${data.constants}
    scaling: ${data.scaling}
    splits: ${data.splits}
    presteps: ${model.presteps}
    input_time_dim: ${data.input_time_dim}
    output_time_dim: ${data.output_time_dim}
    data_time_step: ${data.data_time_step}
    time_step: ${data.time_step}
    gap: ${data.gap}
    shuffle: true
    add_insolation: ${data.add_insolation}
    cube_dim: ${data.cube_dim}
    num_workers: ${num_workers}
    pin_memory: true
    prebuilt_dataset: ${data.prebuilt_dataset}
  scaling:
    t2m0:
      mean: 287.8665771484375
      std: 14.86227798461914
    t850:
      mean: 281.2710266113281
      std: 12.04991626739502
    tau300-700:
      mean: 61902.72265625
      std: 2559.8408203125
    tcwv0:
      mean: 24.034976959228516
      std: 16.411935806274414
    z1000:
      mean: 952.1435546875
      std: 895.7516479492188
    z250:
      mean: 101186.28125
      std: 5551.77978515625
    z500:
      mean: 55625.9609375
      std: 2681.712890625
    tp6:
      mean: 0.0
      std: 1.0
      log_epsilon: 1.0e-06
  splits:
    train_date_start: '1979-01-01'
    train_date_end: 2012-12-31T18:00
    val_date_start: '2013-01-01'
    val_date_end: 2016-12-31T18:00
    test_date_start: '2017-01-01'
    test_date_end: 2018-12-31T18:00
  src_directory: /home/quicksilver2/karlbam/Data/DLWP/HPX64
  dst_directory: /home/quicksilver2/karlbam/Data/DLWP/HPX64
  dataset_name: era5_hpx64_7var_6h_24h
  prefix: era5_0.25deg_3h_HPX64_1979-2021_
  suffix: ''
  data_format: classic
  input_variables:
  - z500
  - tau300-700
  - z1000
  - t2m0
  - tcwv0
  - t850
  - z250
  output_variables: null
  constants:
    land_sea_mask: lsm
    topography: z
  input_time_dim: 2
  output_time_dim: 4
  data_time_step: 3H
  time_step: 6H
  gap: 6H
  add_insolation: true
  nside: 64
  cube_dim: ${data.nside}
  prebuilt_dataset: true
model:
  encoder:
    conv_block:
      activation:
        _target_: training.dlwp.model.modules.activations.CappedGELU
        cap_value: 10
      _target_: training.dlwp.model.modules.blocks.ConvNeXtBlock
      _recursive_: true
      in_channels: 3
      out_channels: 1
      kernel_size: 3
      dilation: 1
      upscale_factor: 4
    down_sampling_block:
      _target_: training.dlwp.model.modules.blocks.AvgPool
      pooling: 2
    recurrent_block:
      _target_: training.dlwp.model.modules.blocks.ConvGRUBlock
      _recursive_: false
      in_channels: 3
      kernel_size: 1
      downscale_factor: 4
    _target_: training.dlwp.model.modules.encoder.UNetEncoder
    _recursive_: false
    n_channels:
    - 136
    - 68
    - 34
    dilations:
    - 1
    - 2
    - 4
  decoder:
    conv_block:
      activation:
        _target_: training.dlwp.model.modules.activations.CappedGELU
        cap_value: 10
      _target_: training.dlwp.model.modules.blocks.ConvNeXtBlock
      _recursive_: true
      in_channels: 3
      out_channels: 1
      kernel_size: 3
      dilation: 1
      upscale_factor: 4
    up_sampling_block:
      activation:
        _target_: training.dlwp.model.modules.activations.CappedGELU
        cap_value: 10
      _target_: training.dlwp.model.modules.blocks.TransposedConvUpsample
      in_channels: 3
      out_channels: 1
      upsampling: 2
    recurrent_block:
      _target_: training.dlwp.model.modules.blocks.ConvGRUBlock
      _recursive_: false
      in_channels: 3
      kernel_size: 1
      downscale_factor: 4
    output_layer:
      _target_: training.dlwp.model.modules.blocks.BasicConvBlock
      in_channels: 3
      out_channels: 2
      kernel_size: 1
      dilation: 1
      n_layers: 1
    _target_: training.dlwp.model.modules.decoder.UNetDecoder
    _recursive_: false
    n_channels:
    - 34
    - 68
    - 136
    dilations:
    - 4
    - 2
    - 1
  _target_: training.dlwp.model.models.unet.HEALPixRecUNet
  _recursive_: false
  presteps: 1
  input_time_dim: ${data.input_time_dim}
  output_time_dim: ${data.output_time_dim}
  delta_time: ${data.time_step}
  input_channels: 7
  output_channels: 7
  n_constants: 2
  decoder_input_channels: 1
  enable_nhwc: false
  enable_healpixpad: true
trainer:
  criterion:
    _target_: training.dlwp.trainer.criterion.BaseMSE
  optimizer:
    _target_: torch.optim.Adam
    lr: ${learning_rate}
  lr_scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingLR
    optimizer: ${model.optimizer}
    T_max: ${trainer.max_epochs}
    eta_min: 0
    last_epoch: -1
    verbose: false
  _target_: training.dlwp.trainer.trainer.Trainer
  _recursive_: true
  max_epochs: 300
  min_epochs: 1
  early_stopping_patience: null
  amp_mode: fp16
  graph_mode: train_eval
  output_dir: ${output_dir}

[2023-10-11 12:13:27,996][__main__][INFO] - experiment working directory: /home/disk/quicksilver/nacc/dlesm/zephyr
[2023-10-11 12:13:28,062][__main__][INFO] - experiment working directory: /home/disk/quicksilver/nacc/dlesm/zephyr
[2023-10-11 12:13:30,372][numexpr.utils][INFO] - Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
[2023-10-11 12:13:30,372][numexpr.utils][INFO] - Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
[2023-10-11 12:13:30,372][numexpr.utils][INFO] - NumExpr defaulting to 8 threads.
[2023-10-11 12:13:30,372][numexpr.utils][INFO] - Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
[2023-10-11 12:13:30,372][numexpr.utils][INFO] - Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
[2023-10-11 12:13:30,373][numexpr.utils][INFO] - NumExpr defaulting to 8 threads.
[2023-10-11 12:13:31,630][training.dlwp.data.data_loading][INFO] - opening input datasets
[2023-10-11 12:13:31,636][training.dlwp.data.data_loading][INFO] - opening input datasets
[2023-10-11 12:13:31,853][numcodecs][DEBUG] - Registering codec 'zlib'
[2023-10-11 12:13:31,853][numcodecs][DEBUG] - Registering codec 'zlib'
[2023-10-11 12:13:31,875][numcodecs][DEBUG] - Registering codec 'gzip'
[2023-10-11 12:13:31,875][numcodecs][DEBUG] - Registering codec 'gzip'
[2023-10-11 12:13:31,876][numcodecs][DEBUG] - Registering codec 'bz2'
[2023-10-11 12:13:31,876][numcodecs][DEBUG] - Registering codec 'bz2'
[2023-10-11 12:13:31,877][numcodecs][DEBUG] - Registering codec 'lzma'
[2023-10-11 12:13:31,878][numcodecs][DEBUG] - Registering codec 'lzma'
[2023-10-11 12:13:31,881][numcodecs][DEBUG] - Registering codec 'blosc'
[2023-10-11 12:13:31,881][numcodecs][DEBUG] - Registering codec 'blosc'
[2023-10-11 12:13:31,881][numcodecs][DEBUG] - Registering codec 'zstd'
[2023-10-11 12:13:31,882][numcodecs][DEBUG] - Registering codec 'lz4'
[2023-10-11 12:13:31,882][numcodecs][DEBUG] - Registering codec 'zstd'
[2023-10-11 12:13:31,882][numcodecs][DEBUG] - Registering codec 'lz4'
[2023-10-11 12:13:31,885][numcodecs][DEBUG] - Registering codec 'astype'
[2023-10-11 12:13:31,885][numcodecs][DEBUG] - Registering codec 'astype'
[2023-10-11 12:13:31,887][numcodecs][DEBUG] - Registering codec 'delta'
[2023-10-11 12:13:31,887][numcodecs][DEBUG] - Registering codec 'delta'
[2023-10-11 12:13:31,889][numcodecs][DEBUG] - Registering codec 'quantize'
[2023-10-11 12:13:31,889][numcodecs][DEBUG] - Registering codec 'quantize'
[2023-10-11 12:13:31,891][numcodecs][DEBUG] - Registering codec 'fixedscaleoffset'
[2023-10-11 12:13:31,891][numcodecs][DEBUG] - Registering codec 'fixedscaleoffset'
[2023-10-11 12:13:31,892][numcodecs][DEBUG] - Registering codec 'packbits'
[2023-10-11 12:13:31,893][numcodecs][DEBUG] - Registering codec 'packbits'
[2023-10-11 12:13:31,894][numcodecs][DEBUG] - Registering codec 'categorize'
[2023-10-11 12:13:31,894][numcodecs][DEBUG] - Registering codec 'categorize'
[2023-10-11 12:13:31,896][numcodecs][DEBUG] - Registering codec 'pickle'
[2023-10-11 12:13:31,896][numcodecs][DEBUG] - Registering codec 'pickle'
[2023-10-11 12:13:31,898][numcodecs][DEBUG] - Registering codec 'base64'
[2023-10-11 12:13:31,898][numcodecs][DEBUG] - Registering codec 'base64'
[2023-10-11 12:13:31,899][numcodecs][DEBUG] - Registering codec 'shuffle'
[2023-10-11 12:13:31,900][numcodecs][DEBUG] - Registering codec 'shuffle'
[2023-10-11 12:13:31,901][numcodecs][DEBUG] - Registering codec 'bitround'
[2023-10-11 12:13:31,901][numcodecs][DEBUG] - Registering codec 'bitround'
[2023-10-11 12:13:31,914][numcodecs][DEBUG] - Registering codec 'msgpack2'
[2023-10-11 12:13:31,914][numcodecs][DEBUG] - Registering codec 'msgpack2'
[2023-10-11 12:13:31,916][numcodecs][DEBUG] - Registering codec 'crc32'
[2023-10-11 12:13:31,916][numcodecs][DEBUG] - Registering codec 'crc32'
[2023-10-11 12:13:31,916][numcodecs][DEBUG] - Registering codec 'adler32'
[2023-10-11 12:13:31,917][numcodecs][DEBUG] - Registering codec 'adler32'
[2023-10-11 12:13:31,918][numcodecs][DEBUG] - Registering codec 'json2'
[2023-10-11 12:13:31,918][numcodecs][DEBUG] - Registering codec 'json2'
[2023-10-11 12:13:31,919][numcodecs][DEBUG] - Registering codec 'vlen-utf8'
[2023-10-11 12:13:31,919][numcodecs][DEBUG] - Registering codec 'vlen-utf8'
[2023-10-11 12:13:31,919][numcodecs][DEBUG] - Registering codec 'vlen-bytes'
[2023-10-11 12:13:31,919][numcodecs][DEBUG] - Registering codec 'vlen-bytes'
[2023-10-11 12:13:31,919][numcodecs][DEBUG] - Registering codec 'vlen-array'
[2023-10-11 12:13:31,919][numcodecs][DEBUG] - Registering codec 'vlen-array'
[2023-10-11 12:13:31,962][numcodecs][DEBUG] - Registering codec 'n5_wrapper'
[2023-10-11 12:13:31,962][numcodecs][DEBUG] - Registering codec 'n5_wrapper'
/home/disk/brume/nacc/anaconda3/envs/zephyr-1.1/lib/python3.10/site-packages/xarray/core/dataset.py:247: UserWarning: The specified Dask chunks separate the stored chunks along dimension "time" starting at index 6. This could degrade performance. Instead, consider rechunking after loading.
  warnings.warn(
/home/disk/brume/nacc/anaconda3/envs/zephyr-1.1/lib/python3.10/site-packages/xarray/core/dataset.py:247: UserWarning: The specified Dask chunks separate the stored chunks along dimension "time" starting at index 6. This could degrade performance. Instead, consider rechunking after loading.
  warnings.warn(
===============================================================================================
Layer (type:depth-idx)                                                 Param #
===============================================================================================
HEALPixRecUNet                                                         --
├─FoldFaces: 1-1                                                       --
├─UnfoldFaces: 1-2                                                     --
├─UNetEncoder: 1-3                                                     --
│    └─ModuleList: 2-1                                                 --
│    │    └─Sequential: 3-1                                            2,829,344
│    │    └─Sequential: 3-2                                            1,027,208
│    │    └─Sequential: 3-3                                            256,972
├─UNetDecoder: 1-4                                                     --
│    └─ModuleList: 2-2                                                 --
│    │    └─ModuleDict: 3-4                                            247,996
│    │    └─ModuleDict: 3-5                                            1,166,404
│    │    └─ModuleDict: 3-6                                            4,292,976
│    └─BasicConvBlock: 2-3                                             --
│    │    └─Sequential: 3-7                                            1,918
===============================================================================================
Total params: 9,822,818
Trainable params: 9,822,818
Non-trainable params: 0
===============================================================================================
===============================================================================================
Layer (type:depth-idx)                                                 Param #
===============================================================================================
HEALPixRecUNet                                                         --
├─FoldFaces: 1-1                                                       --
├─UnfoldFaces: 1-2                                                     --
├─UNetEncoder: 1-3                                                     --
│    └─ModuleList: 2-1                                                 --
│    │    └─Sequential: 3-1                                            2,829,344
│    │    └─Sequential: 3-2                                            1,027,208
│    │    └─Sequential: 3-3                                            256,972
├─UNetDecoder: 1-4                                                     --
│    └─ModuleList: 2-2                                                 --
│    │    └─ModuleDict: 3-4                                            247,996
│    │    └─ModuleDict: 3-5                                            1,166,404
│    │    └─ModuleDict: 3-6                                            4,292,976
│    └─BasicConvBlock: 2-3                                             --
│    │    └─Sequential: 3-7                                            1,918
===============================================================================================
Total params: 9,822,818
Trainable params: 9,822,818
Non-trainable params: 0
===============================================================================================
  0%|          | 0/16556 [00:00<?, ?it/s]  0%|          | 0/16556 [00:00<?, ?it/s]Training   epoch 1/300:   0%|          | 0/16556 [00:03<?, ?it/s]Training   epoch 1/300:   0%|          | 0/16556 [00:05<?, ?it/s]slurmstepd-quicksilver: error: *** STEP 1014.0 ON quicksilver CANCELLED AT 2023-10-11T12:13:49 ***
